<?php
//Hooked into Library Card system
function book_godfatherdeath_getmoduleinfo(){
	$info = array(
		"name"=>"Godfather Death",
		"author"=>"Lonny Luberts - based on Script by WebPixie.",
		"version"=>"1.0",
		"category"=>"Library",
		"download"=>"",
		"prefs" => array(
			"bookread" => "Has the player read this book?, bool|false",
		),
	);
	return $info;
}

function book_godfatherdeath_install(){
	if (!is_module_installed("library")) {
         output("This module requires the Library module to be installed.");
         return false;
      }
	module_addhook("library");
	return true;
}

function book_godfatherdeath_uninstall(){
	return true;
}

function book_godfatherdeath_dohook($hookname, $args){
	global $session;
	$card = get_module_pref("card","library");
	switch($hookname){
	case "library":
	if ($card==1){
			addnav("Grimms Fairy Tales");
			addnav("Godfather Death", "runmodule.php?module=book_godfatherdeath");
		break;
	}
	}
	return $args;
}

function book_godfatherdeath_run(){
	global $session;
	$op = httpget('op');
	page_header("Town Library");
	output("`#`c`bGodfather Death`b`c`n");
	output("`!`cWritten by The Brothers Grimm`c`n`n");
	output("A poor man had twelve children and was forced to work night and day to give them even bread. When therefore the thirteenth came into the world, he knew not what to do in his trouble, but ran out into the great highway, and resolved to ask the first person whom he met to be godfather. The first to meet him was the good God who already knew what filled his heart, and said to him, poor man, I pity you. I will hold your child at its christening, and will take charge of it and make it happy on earth. The man said, who are you. I am God. Then I do not desire to have you for a godfather, said the man, you give to the rich, and leave the poor to hunger. Thus spoke the man, for he did not know how wisely God apportions riches and poverty. He turned therefore away from the Lord, and went farther. Then the devil came to him and said, what do you seek. If you will take me as a godfather for your child, I will give him gold in plenty and all the joys of the world as well. The man asked, who are you. I am the devil. Then I There was once a wizard who used to take the form of a poor man, and went to houses and begged, and caught pretty girls. No one knew whither he carried them, for they were never seen again. One day he appeared before the door of a man who had three pretty daughters. He looked like a poor weak beggar, and carried a basket on his back, as if he meant to collect charitable gifts in it. He begged for a little food, and when the eldest daughter came out and was just handing him a piece of bread, he did but touch her, and she was forced to jump into his basket. Thereupon he hurried off with long strides, and carried her away into a dark forest to his house, which stood in the midst of it. Everything in the house was magnificent. He gave her whatsoever she could possibly desire, and said, my darling, you will certainly be happy with me, for you have everything your heart can wish for. This lasted a few days, and then he said, I must journey forth, and leave you alone for a short time. Here are the keys of the house. You may go everywhere and look at everything except into one room, which this little key opens, and there I forbid you to go on pain of death. He likewise gave her an egg and said, preserve the egg carefully for me, and carry it continually about with you, for a great misfortune would arise from the loss of it.`n`nShe took the keys and the egg, and promised to obey him in everything. When he was gone, she went all round the house from the bottom to the top, and examined everything. The rooms shone with silver and gold, and she thought she had never seen such great splendor. At length she came to the forbidden door. She wished to pass it by, but curiosity let her have no rest. She examined the key, it looked just like any other. She put it in the keyhole and turned it a little, and the door sprang open. But what did she see when she went in. A great bloody basin stood in the middle of the room, and therein lay human beings, dead and hewn to pieces, and hard by was a block of wood, and a gleaming axe lay upon it. She was so terribly alarmed that the egg which she held in her hand fell into the basin. She got it out and wiped the blood off, but in vain, it appeared again in a moment. She washed and scrubbed, but she could not get it off.`n`nIt was not long before the man came back from his journey, and the first things which he asked for were the key and the egg. She gave them to him, but she trembled as she did so, and he saw at once by the red spots that she had been in the bloody chamber. Since you have gone into the room against my will, said he, you shall go back into it against your own. Your life is ended. He threw her down, dragged her along by her hair, cut her head off on the block, and hewed her in pieces so that her blood ran on the ground. Then he threw her into the basin with the rest.`n`nNow I will fetch myself the second, said the wizard, and again he went to the house in the shape of a poor man, and begged. Then the second daughter brought him a piece of bread. He caught her like the first, by simply touching her, and carried her away. She did not fare better than her sister. She allowed herself to be led away by her curiosity, opened the door of the bloody chamber, looked in, and had to atone for it with her life on the wizard's return. Then he went and brought the third sister, but she was clever and wily. When he had given her the keys and the egg, and had left her, she first put the egg away with great care, and then she examined the house, and at last went into the forbidden room. Alas, what did she behold. Both her dear sisters lay there in the basin, cruelly murdered, and cut into pieces. But she began to gather their limbs together and put them in order, head, body, arms and legs. And when nothing further was wanting the limbs began to move and unite themselves together, and both the maidens opened their eyes and were once more alive. Then they rejoiced and kissed and caressed each other.`n`nOn his arrival, the man at once demanded the keys and the egg, and as he could perceive no trace of any blood on it, he said, you have stood the test, you shall be my bride. He now had no longer any power over her, and was forced to do whatsoever she desired. Oh, very well, said she, you shall first take a basketful of gold to my father and mother, and carry it yourself on your back. In the meantime I will prepare for the wedding. Then she ran to her sisters, whom she had hidden in a little chamber, and said, the moment has come when I can save you. The wretch shall himself carry you home again, but as soon as you are at home send help to me. She put both of them in a basket and covered them quite over with gold, so that nothing of them was to be seen. Then she called in the wizard and said to him, now carry the basket away, but I shall look through my little window and watch to see if you stop on the way to stand or to rest.`n`nThe wizard raised the basket on his back and went away with it, but it weighed him down so heavily that the sweat streamed from his face. Then he sat down and wanted to rest awhile, but immediately one of the girls in the basket cried, I am looking through my little window, and I see that you are resting. Will you go on at once. He thought it was his bride who was talking to him, and he got up on his legs again. Once more he was going to sit down, but instantly she cried, I am looking through my little window, and I see that you are resting. Will you go on directly. And whenever he stood still, she cried this, and then he was forced to go onwards, until at last, groaning and out of breath, he took the basket with the gold and the two maidens into their parents, house. At home, however, the bride prepared the marriage-feast, and sent invitations to the friends of the wizard. Then she took a skull with grinning teeth, put some ornaments on it and a wreath of flowers, carried it upstairs to the garret-window, and let it look out from thence. When all was ready, she got into a barrel of honey, and then cut the feather-bed open and rolled herself in it, until she looked like a wondrous bird, and no one could recognize her. Then she went out of the house, and on her way she met some of the wedding-guests, who asked, o, fitcher's bird, how com'st thou here. I come from fitcher's house quite near. And what may the young bride be doing. From cellar to garret she's swept all clean, and now from the window she's peeping, I ween.`n`nAt last she met the bridegroom, who was coming slowly back. He, like the others, asked, o, fitcher's bird, how com'st thou here. I come from fitcher's house quite near. And what may the young bride be doing. From cellar to garret she's swept all clean, and now from the window she's peeping, I ween.`n`nThe bridegroom looked up, saw the decked-out skull, thought it was his bride, and nodded to her, greeting her kindly. But when he and his guests had all gone into the house, the brothers and kinsmen of the bride, who had been sent to rescue her, arrived. They locked all the doors of the house, that no one might escape, set fire to it, and the wizard and all his crew had to burn.do not desire to have you for godfather, said the man, you deceive men and lead them astray. He went onwards, and then came death striding up to him with withered legs, and said, take me as godfather. The man asked, who are you. I am death, and I make all equal. Then said the man, you are the right one, you take the rich as well as the poor, without distinction, you shall be godfather. Death answered, I will make your child rich and famous, for he who has me for a friend can lack nothing. The man said, next sunday is the christening, be there at the right time. Death appeared as he had promised, and stood godfather quite in the usual way. When the boy had grown up, his godfather one day appeared and bade him go with him. He led him forth into a forest, and showed him a herb which grew there, and said, now you shall receive your godfather's present. I make you a celebrated physician. When you are called to a patient, I will always appear to you. If I stand by the head of the sick man, you may say with confidence that you will make him well again, and if you give him of this herb he will recover, but if I stand by the patient's feet, he is mine, and you must say that all remedies are in vain, and that no physician in the world could save him. But beware of using the herb against my will, or it might fare ill with you.`n`nIt was not long before the youth was the most famous physician in the whole world. He had only to look at the patient and he knew his condition at once, whether he would recover, or must needs die. So they said of him, and from far and wide people came to him, sent for him when they had anyone ill, and gave him so much money that he soon became a rich man. Now it so befell that the king became ill, and the physician was summoned, and was to say if recovery were possible. But when he came to the bed, death was standing by the feet of the sick man, and the herb did not grow which could save him. If I could but cheat death for once, thought the physician, he is sure to take it ill if I do but, as I am his godson, he will shut one eye, I will risk it. He therefore took up the sick man, and laid him the other way, so that now death was standing by his head. Then he gave the king some of the herbs, and he recovered and grew healthy again.`n`nBut death came to the physician, looking very black and angry, threatened him with his finger, and said, you have betrayed me, this time I will pardon it, as you are my godson, but if you venture it again, it will cost you your neck, for I will take you yourself away with me.`n`nSoon afterwards the king's daughter fell into a severe illness. She was his only child, and he wept day and night, so that he began to lose the sight of his eyes, and he caused it to be made known that whosoever rescued her from death should be her husband and inherit the crown. When the physician came to the sick girl's bed, he saw death by her feet. He ought to have remembered the warning given by his godfather, but he was so infatuated by the great beauty of the king's daughter, and the happiness of becoming her husband, that he flung all thought to the winds. He did not see that death was casting angry glances on him, that he was raising his hand in the air, and threatening him with his withered fist. He raised up the sick girl, and placed her head where her feet had lain. Then he gave her some of the herb, and instantly her cheeks flushed red, and life stirred afresh in her.`n`nWhen death saw that for a second time his own property had been misused, he walked up to the physician with long strides, and said, all is over with you, and now the lot falls on you, and seized him so firmly with his ice-cold hand, that he could not resist, and led him into a cave below the earth. There he saw how thousands and thousands of candles were burning in countless rows, some large, some medium-sized, others small. Every instant some were extinguished, and others again burnt up, so that the flames seemed to leap hither and thither in perpetual change. See, said death, these are the lights of men's lives. The large ones belong to children, the medium-sized ones to married people in their prime, the little ones belong to old people, but children and young folks likewise have often only a tiny candle. Show me the light of my life, said the physician, and he thought that it would be still very tall. Death pointed to a little end which was just threatening to go out, and said, behold, it is there. Ah, dear godfather, said the horrified physician, light a new one for me, do it for love of me, that I may enjoy my life, be king, and the husband of the king's beautiful daughter. I cannot, answered death, one must go out before a new one is lighted. Then place the old one on a new one, that will go on burning at once when the old one has come to an end, pleaded the physician. Death behaved as if he were going to fulfill his wish, and took hold of a tall new candle, but as he desired to revenge himself, he purposely made a mistake in fixing it, and the little piece fell down and was extinguished. Immediately the physician fell on the ground, and now he himself was in the hands of death.");
	$number = e_rand(1,3);
	if ($number == 3) {
		$session[user][experience]*=1.05;
		output("`!The book has filled you with wisdom beyond your years!  You gain some Experience!`n");
	}
	    addnav("Return Book to Shelf","runmodule.php?module=library");
	    page_footer();
}
?>